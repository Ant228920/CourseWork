-- Military District Management System - Queries
-- All 10 types of queries according to requirements

-- 1) Одержати дані по офіцерському складу загалом та по офіцерському складу із вказаним званням
-- всіх частин, окремої частини, окремої дивізії, окремої армії.

-- Офіцерський склад загалом по всіх частинах
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини",
    д."номер" AS "дивізія", к."номер" AS "корпус", а."номер" AS "армія"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
LEFT JOIN "дивізія" д ON д."id" = ч."дивізія_id"
LEFT JOIN "корпус" к ON к."id" = д."корпус_id"
LEFT JOIN "армія" а ON а."id" = к."армія_id"
WHERE з."категорія" = 'офіцерський'
ORDER BY з."порядок", в."прізвище";

-- Офіцерський склад із вказаним званням по всіх частинах
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
WHERE з."категорія" = 'офіцерський' AND з."назва" = %s
ORDER BY в."прізвище";

-- Офіцерський склад окремої частини
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    в."посада", в."дата_прийняття"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
WHERE з."категорія" = 'офіцерський' AND в."військова_частина_id" = %s
ORDER BY з."порядок", в."прізвище";

-- Офіцерський склад окремої дивізії
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
WHERE з."категорія" = 'офіцерський' AND ч."дивізія_id" = %s
ORDER BY з."порядок", в."прізвище";

-- Офіцерський склад окремої армії
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    в."посада", ч."номер" AS "частина", д."номер" AS "дивізія", к."номер" AS "корпус"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
WHERE з."категорія" = 'офіцерський' AND к."армія_id" = %s
ORDER BY з."порядок", в."прізвище";

-- 2) Одержати дані по рядовому та сержантському складу загалом та по складу із вказаним званням
-- всіх частин, окремої частини, окремої дивізії, окремої армії.

-- Рядовий та сержантський склад загалом
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    з."категорія", в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
WHERE з."категорія" IN ('рядовий', 'сержантський')
ORDER BY з."порядок", в."прізвище";

-- Рядовий та сержантський склад із вказаним званням
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
WHERE з."категорія" IN ('рядовий', 'сержантський') AND з."назва" = %s
ORDER BY в."прізвище";

-- Рядовий та сержантський склад окремої частини
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    з."категорія", в."посада", в."дата_прийняття"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
WHERE з."категорія" IN ('рядовий', 'сержантський') AND в."військова_частина_id" = %s
ORDER BY з."порядок", в."прізвище";

-- Рядовий та сержантський склад окремої дивізії
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    з."категорія", в."посада", ч."номер" AS "частина"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
WHERE з."категорія" IN ('рядовий', 'сержантський') AND ч."дивізія_id" = %s
ORDER BY з."порядок", в."прізвище";

-- Рядовий та сержантський склад окремої армії
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання", 
    з."категорія", в."посада", ч."номер" AS "частина", д."номер" AS "дивізія"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
WHERE з."категорія" IN ('рядовий', 'сержантський') AND к."армія_id" = %s
ORDER BY з."порядок", в."прізвище";

-- 3) Одержати дані про наявність військової техніки загалом та окремо для вказаної категорії
-- у всіх частинах, в окремій частині, в окремій армії, дивізії, корпусі.

-- Військова техніка загалом по всіх частинах
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    тт."назва" AS "тип_техніки", тт."категорія", COUNT(*) AS "кількість"
FROM "техніка" т
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
JOIN "військова_частина" ч ON ч."id" = т."військова_частина_id"
GROUP BY ч."id", ч."номер", ч."назва", тт."назва", тт."категорія"
ORDER BY ч."номер", тт."категорія", тт."назва";

-- Військова техніка вказаної категорії по всіх частинах
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    тт."назва" AS "тип_техніки", COUNT(*) AS "кількість"
FROM "техніка" т
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
JOIN "військова_частина" ч ON ч."id" = т."військова_частина_id"
WHERE тт."категорія" = %s
GROUP BY ч."id", ч."номер", ч."назва", тт."назва"
ORDER BY ч."номер", тт."назва";

-- Військова техніка окремої частини
SELECT 
    т."інвентарний_номер", т."модель", тт."назва" AS "тип_техніки", 
    тт."категорія", т."рік_випуску", т."стан"
FROM "техніка" т
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
WHERE т."військова_частина_id" = %s
ORDER BY тт."категорія", тт."назва", т."інвентарний_номер";

-- Військова техніка окремої армії
SELECT 
    а."номер" AS "армія", к."номер" AS "корпус", д."номер" AS "дивізія",
    ч."номер" AS "частина", тт."назва" AS "тип_техніки", COUNT(*) AS "кількість"
FROM "техніка" т
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
JOIN "військова_частина" ч ON ч."id" = т."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
JOIN "армія" а ON а."id" = к."армія_id"
WHERE к."армія_id" = %s
GROUP BY а."номер", к."номер", д."номер", ч."номер", тт."назва"
ORDER BY к."номер", д."номер", ч."номер", тт."назва";

-- Військова техніка окремої дивізії
SELECT 
    д."номер" AS "дивізія", ч."номер" AS "частина", 
    тт."назва" AS "тип_техніки", COUNT(*) AS "кількість"
FROM "техніка" т
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
JOIN "військова_частина" ч ON ч."id" = т."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
WHERE ч."дивізія_id" = %s
GROUP BY д."номер", ч."номер", тт."назва"
ORDER BY ч."номер", тт."назва";

-- Військова техніка окремого корпусу
SELECT 
    к."номер" AS "корпус", д."номер" AS "дивізія", ч."номер" AS "частина",
    тт."назва" AS "тип_техніки", COUNT(*) AS "кількість"
FROM "техніка" т
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
JOIN "військова_частина" ч ON ч."id" = т."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
WHERE д."корпус_id" = %s
GROUP BY к."номер", д."номер", ч."номер", тт."назва"
ORDER BY д."номер", ч."номер", тт."назва";

-- 4) Одержати дані про наявність озброєння загалом та окремо вказаної категорії
-- у всіх частинах військового округу, у вказаній частині, у вказаній армії, дивізії, корпусі.

-- Озброєння загалом по всіх частинах
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    то."назва" AS "тип_озброєння", то."категорія", COUNT(*) AS "кількість"
FROM "озброєння" о
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
JOIN "військова_частина" ч ON ч."id" = о."військова_частина_id"
GROUP BY ч."id", ч."номер", ч."назва", то."назва", то."категорія"
ORDER BY ч."номер", то."категорія", то."назва";

-- Озброєння вказаної категорії по всіх частинах
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    то."назва" AS "тип_озброєння", COUNT(*) AS "кількість"
FROM "озброєння" о
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
JOIN "військова_частина" ч ON ч."id" = о."військова_частина_id"
WHERE то."категорія" = %s
GROUP BY ч."id", ч."номер", ч."назва", то."назва"
ORDER BY ч."номер", то."назва";

-- Озброєння вказаної частини
SELECT 
    о."серійний_номер", о."модель", то."назва" AS "тип_озброєння", 
    то."категорія", о."стан"
FROM "озброєння" о
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
WHERE о."військова_частина_id" = %s
ORDER BY то."категорія", то."назва", о."серійний_номер";

-- Озброєння вказаної армії
SELECT 
    а."номер" AS "армія", к."номер" AS "корпус", д."номер" AS "дивізія",
    ч."номер" AS "частина", то."назва" AS "тип_озброєння", COUNT(*) AS "кількість"
FROM "озброєння" о
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
JOIN "військова_частина" ч ON ч."id" = о."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
JOIN "армія" а ON а."id" = к."армія_id"
WHERE к."армія_id" = %s
GROUP BY а."номер", к."номер", д."номер", ч."номер", то."назва"
ORDER BY к."номер", д."номер", ч."номер", то."назва";

-- Озброєння вказаної дивізії
SELECT 
    д."номер" AS "дивізія", ч."номер" AS "частина", 
    то."назва" AS "тип_озброєння", COUNT(*) AS "кількість"
FROM "озброєння" о
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
JOIN "військова_частина" ч ON ч."id" = о."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
WHERE ч."дивізія_id" = %s
GROUP BY д."номер", ч."номер", то."назва"
ORDER BY ч."номер", то."назва";

-- Озброєння вказаного корпусу
SELECT 
    к."номер" AS "корпус", д."номер" AS "дивізія", ч."номер" AS "частина",
    то."назва" AS "тип_озброєння", COUNT(*) AS "кількість"
FROM "озброєння" о
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
JOIN "військова_частина" ч ON ч."id" = о."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
WHERE д."корпус_id" = %s
GROUP BY к."номер", д."номер", ч."номер", то."назва"
ORDER BY д."номер", ч."номер", то."назва";

-- 5) Одержати інформацію про армію, дивізію, корпус, у які входить найбільше (найменше) військових частин.

-- Армія з найбільшою кількістю частин
SELECT 
    а."номер" AS "армія", а."назва" AS "назва_армії", 
    COUNT(ч."id") AS "кількість_частин"
FROM "армія" а
LEFT JOIN "корпус" к ON к."армія_id" = а."id"
LEFT JOIN "дивізія" д ON д."корпус_id" = к."id"
LEFT JOIN "військова_частина" ч ON ч."дивізія_id" = д."id"
GROUP BY а."id", а."номер", а."назва"
ORDER BY "кількість_частин" DESC
LIMIT 1;

-- Армія з найменшою кількістю частин
SELECT 
    а."номер" AS "армія", а."назва" AS "назва_армії", 
    COUNT(ч."id") AS "кількість_частин"
FROM "армія" а
LEFT JOIN "корпус" к ON к."армія_id" = а."id"
LEFT JOIN "дивізія" д ON д."корпус_id" = к."id"
LEFT JOIN "військова_частина" ч ON ч."дивізія_id" = д."id"
GROUP BY а."id", а."номер", а."назва"
ORDER BY "кількість_частин" ASC
LIMIT 1;

-- Дивізія з найбільшою кількістю частин
SELECT 
    д."номер" AS "дивізія", д."тип" AS "тип_дивізії",
    к."номер" AS "корпус", а."номер" AS "армія",
    COUNT(ч."id") AS "кількість_частин"
FROM "дивізія" д
JOIN "корпус" к ON к."id" = д."корпус_id"
JOIN "армія" а ON а."id" = к."армія_id"
LEFT JOIN "військова_частина" ч ON ч."дивізія_id" = д."id"
GROUP BY д."id", д."номер", д."тип", к."номер", а."номер"
ORDER BY "кількість_частин" DESC
LIMIT 1;

-- Дивізія з найменшою кількістю частин
SELECT 
    д."номер" AS "дивізія", д."тип" AS "тип_дивізії",
    к."номер" AS "корпус", а."номер" AS "армія",
    COUNT(ч."id") AS "кількість_частин"
FROM "дивізія" д
JOIN "корпус" к ON к."id" = д."корпус_id"
JOIN "армія" а ON а."id" = к."армія_id"
LEFT JOIN "військова_частина" ч ON ч."дивізія_id" = д."id"
GROUP BY д."id", д."номер", д."тип", к."номер", а."номер"
ORDER BY "кількість_частин" ASC
LIMIT 1;

-- Корпус з найбільшою кількістю частин
SELECT 
    к."номер" AS "корпус", а."номер" AS "армія",
    COUNT(ч."id") AS "кількість_частин"
FROM "корпус" к
JOIN "армія" а ON а."id" = к."армія_id"
LEFT JOIN "дивізія" д ON д."корпус_id" = к."id"
LEFT JOIN "військова_частина" ч ON ч."дивізія_id" = д."id"
GROUP BY к."id", к."номер", а."номер"
ORDER BY "кількість_частин" DESC
LIMIT 1;

-- Корпус з найменшою кількістю частин
SELECT 
    к."номер" AS "корпус", а."номер" AS "армія",
    COUNT(ч."id") AS "кількість_частин"
FROM "корпус" к
JOIN "армія" а ON а."id" = к."армія_id"
LEFT JOIN "дивізія" д ON д."корпус_id" = к."id"
LEFT JOIN "військова_частина" ч ON ч."дивізія_id" = д."id"
GROUP BY к."id", к."номер", а."номер"
ORDER BY "кількість_частин" ASC
LIMIT 1;

-- 6) Одержати перелік всіх частин військового округу, вказаної армії, дивізії, корпусу
-- та вказати у кожному випадку їх керівників.

-- Перелік всіх частин військового округу з керівниками
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    д."номер" AS "дивізія", к."номер" AS "корпус", а."номер" AS "армія",
    о."назва" AS "округ",
    кер."прізвище" || ' ' || кер."ім'я" || ' ' || COALESCE(кер."по_батькові", '') AS "керівник",
    з."назва" AS "звання_керівника"
FROM "військова_частина" ч
LEFT JOIN "дивізія" д ON д."id" = ч."дивізія_id"
LEFT JOIN "корпус" к ON к."id" = д."корпус_id"
LEFT JOIN "армія" а ON а."id" = к."армія_id"
LEFT JOIN "військовий_округ" о ON о."id" = а."військовий_округ_id"
LEFT JOIN "військовослужбовець" кер ON кер."військова_частина_id" = ч."id" 
    AND кер."посада" LIKE '%командир%'
LEFT JOIN "звання" з ON з."id" = кер."звання_id"
ORDER BY о."назва", а."номер", к."номер", д."номер", ч."номер";

-- Перелік частин вказаної армії з керівниками
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    д."номер" AS "дивізія", к."номер" AS "корпус",
    кер."прізвище" || ' ' || кер."ім'я" || ' ' || COALESCE(кер."по_батькові", '') AS "керівник",
    з."назва" AS "звання_керівника"
FROM "військова_частина" ч
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
LEFT JOIN "військовослужбовець" кер ON кер."військова_частина_id" = ч."id" 
    AND кер."посада" LIKE '%командир%'
LEFT JOIN "звання" з ON з."id" = кер."звання_id"
WHERE к."армія_id" = %s
ORDER BY к."номер", д."номер", ч."номер";

-- Перелік частин вказаної дивізії з керівниками
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    кер."прізвище" || ' ' || кер."ім'я" || ' ' || COALESCE(кер."по_батькові", '') AS "керівник",
    з."назва" AS "звання_керівника"
FROM "військова_частина" ч
LEFT JOIN "військовослужбовець" кер ON кер."військова_частина_id" = ч."id" 
    AND кер."посада" LIKE '%командир%'
LEFT JOIN "звання" з ON з."id" = кер."звання_id"
WHERE ч."дивізія_id" = %s
ORDER BY ч."номер";

-- Перелік частин вказаного корпусу з керівниками
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    д."номер" AS "дивізія",
    кер."прізвище" || ' ' || кер."ім'я" || ' ' || COALESCE(кер."по_батькові", '') AS "керівник",
    з."назва" AS "звання_керівника"
FROM "військова_частина" ч
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
LEFT JOIN "військовослужбовець" кер ON кер."військова_частина_id" = ч."id" 
    AND кер."посада" LIKE '%командир%'
LEFT JOIN "звання" з ON з."id" = кер."звання_id"
WHERE д."корпус_id" = %s
ORDER BY д."номер", ч."номер";

-- 7) Одержати перелік місць дислокації для всіх частин військового округу,
-- окремої військової частини, окремої армії, дивізії, корпусу.

-- Перелік місць дислокації для всіх частин військового округу
SELECT DISTINCT
    мд."назва" AS "місце_дислокації", мд."адреса", мд."тип",
    о."назва" AS "округ", а."номер" AS "армія", к."номер" AS "корпус", д."номер" AS "дивізія",
    COUNT(ч."id") AS "кількість_частин"
FROM "місце_дислокації" мд
JOIN "військова_частина" ч ON ч."місце_дислокації_id" = мд."id"
LEFT JOIN "дивізія" д ON д."id" = ч."дивізія_id"
LEFT JOIN "корпус" к ON к."id" = д."корпус_id"
LEFT JOIN "армія" а ON а."id" = к."армія_id"
LEFT JOIN "військовий_округ" о ON о."id" = а."військовий_округ_id"
GROUP BY мд."id", мд."назва", мд."адреса", мд."тип", о."назва", а."номер", к."номер", д."номер"
ORDER BY о."назва", а."номер", к."номер", д."номер", мд."назва";

-- Перелік місць дислокації окремої військової частини
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    мд."назва" AS "місце_дислокації", мд."адреса", мд."тип", мд."координати"
FROM "військова_частина" ч
JOIN "місце_дислокації" мд ON мд."id" = ч."місце_дислокації_id"
WHERE ч."id" = %s;

-- Перелік місць дислокації окремої армії
SELECT DISTINCT
    мд."назва" AS "місце_дислокації", мд."адреса", мд."тип",
    к."номер" AS "корпус", д."номер" AS "дивізія",
    COUNT(ч."id") AS "кількість_частин"
FROM "місце_дислокації" мд
JOIN "військова_частина" ч ON ч."місце_дислокації_id" = мд."id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
WHERE к."армія_id" = %s
GROUP BY мд."id", мд."назва", мд."адреса", мд."тип", к."номер", д."номер"
ORDER BY к."номер", д."номер", мд."назва";

-- Перелік місць дислокації окремої дивізії
SELECT DISTINCT
    мд."назва" AS "місце_дислокації", мд."адреса", мд."тип",
    д."номер" AS "дивізія", COUNT(ч."id") AS "кількість_частин"
FROM "місце_дислокації" мд
JOIN "військова_частина" ч ON ч."місце_дислокації_id" = мд."id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
WHERE ч."дивізія_id" = %s
GROUP BY мд."id", мд."назва", мд."адреса", мд."тип", д."номер"
ORDER BY д."номер", мд."назва";

-- Перелік місць дислокації окремого корпусу
SELECT DISTINCT
    мд."назва" AS "місце_дислокації", мд."адреса", мд."тип",
    к."номер" AS "корпус", д."номер" AS "дивізія", COUNT(ч."id") AS "кількість_частин"
FROM "місце_дислокації" мд
JOIN "військова_частина" ч ON ч."місце_дислокації_id" = мд."id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
WHERE д."корпус_id" = %s
GROUP BY мд."id", мд."назва", мд."адреса", мд."тип", к."номер", д."номер"
ORDER BY к."номер", д."номер", мд."назва";

-- 8) Одержати список військових частин, в яких знаходиться вказана кількість певного виду бойової техніки
-- (нема вказаного виду бойової техніки), у яких є вказана кількість одиниць даного виду озброєння,
-- немає жодної одиниці вказаного виду озброєння.

-- Частини з вказаною кількістю певного виду бойової техніки
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    тт."назва" AS "тип_техніки", COUNT(т."id") AS "кількість"
FROM "військова_частина" ч
JOIN "техніка" т ON т."військова_частина_id" = ч."id"
JOIN "тип_техніки" тт ON тт."id" = т."тип_техніки_id"
WHERE тт."назва" = %s
GROUP BY ч."id", ч."номер", ч."назва", тт."назва"
HAVING COUNT(т."id") = %s
ORDER BY ч."номер";

-- Частини без вказаного виду бойової техніки
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини"
FROM "військова_частина" ч
LEFT JOIN "техніка" т ON т."військова_частина_id" = ч."id"
    AND т."тип_техніки_id" = (SELECT "id" FROM "тип_техніки" WHERE "назва" = %s)
WHERE т."id" IS NULL
ORDER BY ч."номер";

-- Частини з вказаною кількістю одиниць даного виду озброєння
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини",
    то."назва" AS "тип_озброєння", COUNT(о."id") AS "кількість"
FROM "військова_частина" ч
JOIN "озброєння" о ON о."військова_частина_id" = ч."id"
JOIN "тип_озброєння" то ON то."id" = о."тип_озброєння_id"
WHERE то."назва" = %s
GROUP BY ч."id", ч."номер", ч."назва", то."назва"
HAVING COUNT(о."id") = %s
ORDER BY ч."номер";

-- Частини без жодної одиниці вказаного виду озброєння
SELECT 
    ч."номер" AS "частина", ч."назва" AS "назва_частини"
FROM "військова_частина" ч
LEFT JOIN "озброєння" о ON о."військова_частина_id" = ч."id"
    AND о."тип_озброєння_id" = (SELECT "id" FROM "тип_озброєння" WHERE "назва" = %s)
WHERE о."id" IS NULL
ORDER BY ч."номер";

-- 9) Одержати список військовослужбовців вказаної спеціальності у вказаному окрузі,
-- у вказаній армії, військовій частині, у вказаному підрозділі вказаної військової частини.

-- Військовослужбовці вказаної спеціальності у вказаному окрузі
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання",
    в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини",
    д."номер" AS "дивізія", к."номер" AS "корпус", а."номер" AS "армія",
    о."назва" AS "округ"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
JOIN "армія" а ON а."id" = к."армія_id"
JOIN "військовий_округ" о ON о."id" = а."військовий_округ_id"
JOIN "військова_спеціальність" вс ON вс."id" = в."військова_спеціальність_id"
WHERE вс."назва" = %s AND о."id" = %s
ORDER BY а."номер", к."номер", д."номер", ч."номер", в."прізвище";

-- Військовослужбовці вказаної спеціальності у вказаній армії
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання",
    в."посада", ч."номер" AS "частина", ч."назва" AS "назва_частини",
    д."номер" AS "дивізія", к."номер" AS "корпус"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_частина" ч ON ч."id" = в."військова_частина_id"
JOIN "дивізія" д ON д."id" = ч."дивізія_id"
JOIN "корпус" к ON к."id" = д."корпус_id"
JOIN "військова_спеціальність" вс ON вс."id" = в."військова_спеціальність_id"
WHERE вс."назва" = %s AND к."армія_id" = %s
ORDER BY к."номер", д."номер", ч."номер", в."прізвище";

-- Військовослужбовці вказаної спеціальності у вказаній військовій частині
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання",
    в."посада", в."дата_прийняття"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "військова_спеціальність" вс ON вс."id" = в."військова_спеціальність_id"
WHERE вс."назва" = %s AND в."військова_частина_id" = %s
ORDER BY з."порядок", в."прізвище";

-- Військовослужбовці вказаної спеціальності у вказаному підрозділі вказаної військової частини
SELECT 
    в."прізвище", в."ім'я", в."по_батькові", з."назва" AS "звання",
    в."посада", в."дата_прийняття", від."номер" AS "відділення", від."назва" AS "назва_відділення"
FROM "військовослужбовець" в
JOIN "звання" з ON з."id" = в."звання_id"
JOIN "відділення" від ON від."id" = в."відділення_id"
JOIN "військова_спеціальність" вс ON вс."id" = в."військова_спеціальність_id"
WHERE вс."назва" = %s AND в."військова_частина_id" = %s AND від."id" = %s
ORDER BY з."порядок", в."прізвище";

-- 10) Одержати список споруд вказаної військової частини та список споруд,
-- де дислокується більше одного підрозділу, не дислокується жодного підрозділу.

-- Список споруд вказаної військової частини
SELECT 
    с."назва" AS "споруда", с."тип", с."адреса",
    мд."назва" AS "місце_дислокації", мд."тип" AS "тип_місця"
FROM "споруда" с
LEFT JOIN "місце_дислокації" мд ON мд."id" = с."місце_дислокації_id"
WHERE с."військова_частина_id" = %s
ORDER BY с."тип", с."назва";

-- Споруди, де дислокується більше одного підрозділу
SELECT 
    с."назва" AS "споруда", с."тип", с."адреса",
    мд."назва" AS "місце_дислокації",
    COUNT(DISTINCT ч."id") AS "кількість_частин"
FROM "споруда" с
JOIN "місце_дислокації" мд ON мд."id" = с."місце_дислокації_id"
JOIN "військова_частина" ч ON ч."місце_дислокації_id" = мд."id"
GROUP BY с."id", с."назва", с."тип", с."адреса", мд."назва"
HAVING COUNT(DISTINCT ч."id") > 1
ORDER BY "кількість_частин" DESC, с."назва";

-- Споруди, де не дислокується жодного підрозділу
SELECT 
    с."назва" AS "споруда", с."тип", с."адреса",
    мд."назва" AS "місце_дислокації"
FROM "споруда" с
LEFT JOIN "місце_дислокації" мд ON мд."id" = с."місце_дислокації_id"
LEFT JOIN "військова_частина" ч ON ч."місце_дислокації_id" = мд."id"
WHERE ч."id" IS NULL
ORDER BY с."тип", с."назва";
